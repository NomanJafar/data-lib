# Data-Lib

Data-Lib is a comprehensive solution for managing database migrations using **Alembic**. Alembic is a lightweight database migration tool for use with SQLAlchemy, facilitating schema changes in a versioned manner for your application. This guide will walk you through setting up your environment, managing migrations, and troubleshooting common issues.

## Table of Contents

- [Project Structure](#project-structure)
- [Setup](#setup)
  - [Create a Virtual Environment](#create-a-virtual-environment)
  - [Activate the Virtual Environment](#activate-the-virtual-environment)
  - [Install the Package](#install-the-package)
- [Creating Migrations](#creating-migrations)
  - [Generate a Migration](#generate-a-migration)
  - [Apply Migrations](#apply-migrations)
- [Additional Information](#additional-information)
  - [Alembic Configuration](#alembic-configuration)
  - [Version Control](#version-control)
  - [Rollback Migrations](#rollback-migrations)
- [Troubleshooting](#troubleshooting)
  - [Missing Migration File](#missing-migration-file)
  - [Database Connection Issues](#database-connection-issues)


- **alembic/**: Contains migration files generated by Alembic.
- **data_lib/**: Contains the core logic of your application, including models and database schemas.
- **alembic.ini**: Configuration file for Alembic, containing database URL and other migration settings.
- **requirements.txt**: A file listing the Python packages required for the project.
- **pyproject.toml**: Configures the project dependencies, setup, and packaging details.
- **README.md**: Documentation file (this one!) explaining how to set up and manage the project.

## Setup

To get started with the project, follow the steps below.

### Clone the Repo

### Create a Virtual Environment + activate this

A virtual environment is recommended to isolate your project's dependencies and avoid conflicts with other Python projects. Run the following commands based on your operating system: $python -m venv .venv


### Install All dependencies 

$ poetry install
$ pip install -r requirements.txt

### To Create Migrations for the first time 

$ alembic revision --autogenerate -m "intial migrations"

- same command will be used when you make any changes into database models.
- verify the alembic autogenerated db scripts (under alembic/versions direcotry) before applying migrations
- to apply migrations run follwoing command:

$ alembic upgrade head

# Checklist

 

Checklist for every developer working on database:

- [ ] Table name & Class name are synced- [ ] Class name is singular and table name is plural
- [ ] Model inherits Base model or Audit trail model as per need
- [ ] Column names are logical as per data columns are going to contain
- [ ] Foreign keys should be named after parent table and have '_id' as suffix
- [ ] Avoid unnecessary denormalization
- [ ] Columns have appropriate data types
- [ ] Tables have appropriate relationship properties (backref, back_populates) as per need
- [ ] Tables have appropriate unique constraints (either composite or single)
- [ ] Tables have appropriate indexes (avoid adding unnecessary indexes)
- [ ] Once done with all the required Table and Column changes, take latest pull from develop branch, upgrade head and then


Generate your own migration

- [ ] Update package version in setup.py and pyproject.toml file (if required)
- [ ] Get it reviewed

